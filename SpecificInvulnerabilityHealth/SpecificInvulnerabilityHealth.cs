using System.Collections.Generic;
using MoreMountains.TopDownEngine;
using UnityEngine;

namespace SpecificInvulnerabilityHealth
{
    public class SpecificInvulnerabilityHealth : Health
    {
        private readonly Dictionary<GameObject, float> _instigatorLastDamageTime = new Dictionary<GameObject, float>();

        public override void Damage(int damage, GameObject instigator, float flickerDuration, float invincibilityDuration, Vector3 damageDirection)
        {
            if (_instigatorLastDamageTime.TryGetValue(instigator, out var lastDamageTime) && Time.time - lastDamageTime < invincibilityDuration) return;
            _instigatorLastDamageTime[instigator] = Time.time;
            base.Damage(damage, instigator, 0, 0, damageDirection);
        }
    }
}
